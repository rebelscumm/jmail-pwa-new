# name: Azure Static Web Apps CI/CD (dev)

# on:
#   push:
#     branches:
#       - master
#       - main
#   pull_request:
#     types: [opened, synchronize, reopened, closed]
#     branches:
#       - master
#       - main

# jobs:
#   build_and_deploy_app_subdomain:
#     if: github.event_name == 'push' || (github.event_name == 'pull_request' && github.event.action != 'closed')
#     runs-on: ubuntu-latest
#     name: Build and Deploy Job (dev)
#     steps:
#       - uses: actions/checkout@v4
#         with:
#           submodules: true
#           lfs: false
#       - name: Build And Deploy to dev environment
#         id: builddeploy_app_subdomain
#         uses: Azure/static-web-apps-deploy@v1
#         with:
#           # Use the same Static Web Apps token so this deploy targets the same property
#           azure_static_web_apps_api_token: ${{ secrets.AZURE_STATIC_WEB_APPS_API_TOKEN_POLITE_COAST_0D53A9710 }}
#           repo_token: ${{ secrets.GITHUB_TOKEN }} # Used for Github integrations (i.e. PR comments)
#           action: "upload"
#           deployment_environment: "staging"
#           ###### Repository/Build Configurations - These values can be configured to match your app requirements. ######
#           app_location: "/svelte-app" # App source code path
#           api_location: "api" # Api source code path - optional
#           output_location: "build" # Built app content directory - optional
#           ###### End of Repository/Build Configurations ######

#       - name: Notify Deployment Success
#         if: success() && github.event_name == 'push'
#         run: |
#           COMMIT_MSG=$(git log -1 --pretty=format:"%s" ${{ github.sha }})
#           COMMIT_AUTHOR=$(git log -1 --pretty=format:"%an" ${{ github.sha }})
#           COMMIT_SHORT=$(echo ${{ github.sha }} | cut -c1-7)
#           BRANCH="${{ github.ref_name }}"
#           
#           TOPIC="${NTFY_TOPIC:-jmail-pwa-deploy}"
#           
#           curl -H "Title: Deployment Successful (Dev)" \
#                -H "Priority: default" \
#                -d "Dev deployment completed successfully!
# 
#           Branch: $BRANCH
#           Commit: $COMMIT_SHORT
#           Author: $COMMIT_AUTHOR
#           Message: $COMMIT_MSG
#           
#           Ready to test!" \
#                https://ntfy.sh/$TOPIC || echo "Notification failed (optional)"
#         env:
#           NTFY_TOPIC: ${{ secrets.NTFY_TOPIC }}

#       # Display deployment URLs
#       - name: Display Deployment Information
#         if: always()
#         run: |
#           echo "ðŸš€ Development Deployment Summary:"
#           echo "Staging URL: https://staging.polite-coast-0d53a9710.1.azurestaticapps.net"
#           echo "Note: Azure Static Web Apps creates staging environments automatically"
#           echo ""
#           echo "ðŸ”’ SSL Certificate Information:"
#           echo "Staging environment is secured with SSL certificates automatically provided by Azure Static Web Apps"
#           echo "No browser warnings should occur as Azure manages certificates for staging environments"


